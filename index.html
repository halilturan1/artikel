<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Der Die Das - Almanca Artikel Oyunu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f3f4f6;
        }
        .card-anim {
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .card-anim:active {
            transform: scale(0.95);
        }
        .shake {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        .correct-pop {
            animation: pop 0.4s;
        }
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        /* Article specific button styles */
        .btn-der:hover { background-color: #2563eb; border-color: #1e40af; }
        .btn-die:hover { background-color: #dc2626; border-color: #991b1b; }
        .btn-das:hover { background-color: #16a34a; border-color: #166534; }
        
        .hidden-screen {
            display: none;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-800 to-slate-900 text-white p-4">

    <!-- START SCREEN -->
    <div id="start-screen" class="w-full max-w-md bg-white text-slate-800 rounded-3xl shadow-2xl p-8 text-center">
        <div class="text-6xl mb-4">ğŸ‡©ğŸ‡ª</div>
        <h1 class="text-3xl font-black mb-2 text-slate-800">Artikel UstasÄ±</h1>
        <p class="text-slate-500 mb-8">KÄ±rtasiye & Okul EÅŸyalarÄ±</p>
        
        <div class="space-y-4">
            <div>
                <label class="block text-left text-sm font-bold text-slate-400 mb-1 ml-1">OYUNCU ADI</label>
                <input type="text" id="username-input" placeholder="AdÄ±nÄ± yaz..." class="w-full bg-slate-100 border-2 border-slate-200 rounded-xl p-4 font-bold text-lg focus:outline-none focus:border-blue-500 transition-colors" maxlength="12">
            </div>
            
            <button onclick="startGame()" class="w-full bg-blue-600 text-white py-4 rounded-xl font-black text-xl shadow-lg hover:bg-blue-500 transform hover:scale-105 transition-all">
                BAÅLA
            </button>
        </div>

        <!-- Mini Leaderboard Preview -->
        <div class="mt-8 pt-6 border-t border-slate-100">
            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">Son Åampiyonlar</h3>
            <div id="mini-leaderboard" class="space-y-2 text-sm">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- GAME CONTAINER -->
    <div id="game-screen" class="hidden-screen w-full max-w-md bg-white text-slate-800 rounded-3xl shadow-2xl overflow-hidden relative">
        
        <!-- Header / Stats -->
        <div class="bg-slate-100 p-4 flex justify-between items-center border-b border-slate-200">
            <div class="flex flex-col items-center w-1/3">
                <span class="text-xs font-bold text-slate-400 uppercase tracking-wider">Oyuncu</span>
                <span id="display-username" class="text-sm font-black text-blue-600 truncate w-full text-center">...</span>
            </div>
            <div class="flex flex-col items-center w-1/3 border-x border-slate-200">
                <span class="text-xs font-bold text-slate-400 uppercase tracking-wider">Skor</span>
                <span id="score" class="text-2xl font-black text-slate-700">0</span>
            </div>
            <div class="flex flex-col items-center w-1/3">
                <span class="text-xs font-bold text-slate-400 uppercase tracking-wider">Seri</span>
                <span id="streak" class="text-2xl font-black text-orange-500">0</span>
            </div>
        </div>

        <!-- Question Area -->
        <div class="p-8 flex flex-col items-center justify-center min-h-[250px] relative" id="card-area">
            <div id="icon-display" class="text-6xl mb-4 transition-all duration-300">âœï¸</div>
            <h1 id="word-display" class="text-4xl font-black mb-2 text-slate-800 text-center tracking-tight">Bleistift</h1>
            <p id="translation-display" class="text-slate-500 font-medium text-lg bg-slate-100 px-3 py-1 rounded-full">KurÅŸun Kalem</p>
            
            <!-- Result Overlay -->
            <div id="result-overlay" class="absolute inset-0 bg-white/95 backdrop-blur-sm flex flex-col items-center justify-center hidden z-10 rounded-xl">
                <div id="result-icon" class="text-6xl mb-2">âœ…</div>
                <h2 id="result-title" class="text-2xl font-bold mb-1">DoÄŸru!</h2>
                <p id="result-message" class="text-slate-600">Cevap: <span class="font-bold">Der</span> Bleistift</p>
                <button onclick="nextQuestion()" class="mt-6 bg-slate-800 text-white px-8 py-3 rounded-full font-bold shadow-lg hover:bg-slate-700 transition transform hover:scale-105 active:scale-95">
                    Devam Et ->
                </button>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="w-full h-2 bg-slate-100">
            <div id="timer-bar" class="h-full bg-blue-500 w-full transition-all duration-1000 ease-linear"></div>
        </div>

        <!-- Controls -->
        <div class="p-6 grid grid-cols-3 gap-3 bg-slate-50">
            <button onclick="checkAnswer('der')" class="card-anim btn-der h-24 rounded-xl bg-blue-100 border-b-4 border-blue-500 text-blue-600 font-black text-xl flex flex-col items-center justify-center group transition-colors">
                <span class="text-sm font-medium opacity-60 mb-1 group-hover:text-white">ERKEK</span>
                <span class="group-hover:text-white">DER</span>
            </button>
            <button onclick="checkAnswer('die')" class="card-anim btn-die h-24 rounded-xl bg-red-100 border-b-4 border-red-500 text-red-600 font-black text-xl flex flex-col items-center justify-center group transition-colors">
                <span class="text-sm font-medium opacity-60 mb-1 group-hover:text-white">DÄ°ÅÄ°</span>
                <span class="group-hover:text-white">DIE</span>
            </button>
            <button onclick="checkAnswer('das')" class="card-anim btn-das h-24 rounded-xl bg-green-100 border-b-4 border-green-500 text-green-600 font-black text-xl flex flex-col items-center justify-center group transition-colors">
                <span class="text-sm font-medium opacity-60 mb-1 group-hover:text-white">NÃ–TR</span>
                <span class="group-hover:text-white">DAS</span>
            </button>
        </div>
        
        <div class="bg-slate-50 border-t border-slate-200 p-3 flex justify-center">
            <button onclick="endGame()" class="text-xs font-bold text-red-500 hover:text-red-700 uppercase tracking-widest border border-red-200 px-4 py-2 rounded-lg hover:bg-red-50 transition-colors">
                Oyunu Bitir ve Kaydet
            </button>
        </div>
    </div>

    <!-- LEADERBOARD SCREEN -->
    <div id="leaderboard-screen" class="hidden-screen w-full max-w-md bg-white text-slate-800 rounded-3xl shadow-2xl p-8 text-center relative">
        <div class="text-6xl mb-4">ğŸ†</div>
        <h2 class="text-2xl font-black text-slate-800 mb-1">Oyun Bitti!</h2>
        <p class="text-slate-500 mb-6">Tebrikler <span id="final-username" class="font-bold text-slate-800"></span></p>

        <div class="bg-blue-50 rounded-xl p-4 mb-6">
            <span class="text-sm text-blue-400 font-bold uppercase block mb-1">TOPLAM SKOR</span>
            <span id="final-score" class="text-5xl font-black text-blue-600">0</span>
        </div>

        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3 text-left">Liderlik Tablosu</h3>
        <div id="full-leaderboard" class="space-y-2 mb-8 max-h-48 overflow-y-auto">
            <!-- Populated by JS -->
        </div>

        <button onclick="resetGame()" class="w-full bg-slate-800 text-white py-4 rounded-xl font-black text-xl shadow-lg hover:bg-slate-700 transform hover:scale-105 transition-all">
            TEKRAR OYNA
        </button>
    </div>

    <script>
        // Database
        const wordDatabase = [
            // DER (Masculine)
            { word: 'Bleistift', art: 'der', tr: 'KurÅŸun Kalem', icon: 'âœï¸' },
            { word: 'Kugelschreiber', art: 'der', tr: 'TÃ¼kenmez Kalem', icon: 'ğŸ–Šï¸' },
            { word: 'Radiergummi', art: 'der', tr: 'Silgi', icon: 'ğŸ§¼' },
            { word: 'Spitzer', art: 'der', tr: 'KalemtraÅŸ', icon: 'âš™ï¸' },
            { word: 'Rucksack', art: 'der', tr: 'SÄ±rt Ã‡antasÄ±', icon: 'ğŸ’' },
            { word: 'Marker', art: 'der', tr: 'KeÃ§eli Kalem', icon: 'ğŸ–ï¸' },
            { word: 'Ordner', art: 'der', tr: 'KlasÃ¶r', icon: 'ğŸ“' },
            { word: 'Klebstoff', art: 'der', tr: 'YapÄ±ÅŸtÄ±rÄ±cÄ±', icon: 'ğŸ§´' },
            { word: 'Rechner', art: 'der', tr: 'Hesap Makinesi', icon: 'ğŸ§®' },
            { word: 'Pinsel', art: 'der', tr: 'FÄ±rÃ§a', icon: 'ğŸ–Œï¸' },
            // DIE (Feminine)
            { word: 'Schere', art: 'die', tr: 'Makas', icon: 'âœ‚ï¸' },
            { word: 'Tasche', art: 'die', tr: 'Ã‡anta', icon: 'ğŸ‘œ' },
            { word: 'Schultasche', art: 'die', tr: 'Okul Ã‡antasÄ±', icon: 'ğŸ’' },
            { word: 'Tafel', art: 'die', tr: 'YazÄ± TahtasÄ±', icon: 'ğŸ«' },
            { word: 'Landkarte', art: 'die', tr: 'Harita', icon: 'ğŸ—ºï¸' },
            { word: 'Mappe', art: 'die', tr: 'Dosya', icon: 'ğŸ“‚' },
            { word: 'Kreide', art: 'die', tr: 'TebeÅŸir', icon: 'âšª' },
            { word: 'Schule', art: 'die', tr: 'Okul', icon: 'ğŸ«' },
            { word: 'Bibliothek', art: 'die', tr: 'KÃ¼tÃ¼phane', icon: 'ğŸ“š' },
            { word: 'Pause', art: 'die', tr: 'TeneffÃ¼s', icon: 'ğŸ””' },
            // DAS (Neutral)
            { word: 'Buch', art: 'das', tr: 'Kitap', icon: 'ğŸ“–' },
            { word: 'Heft', art: 'das', tr: 'Defter', icon: 'ğŸ““' },
            { word: 'Papier', art: 'das', tr: 'KaÄŸÄ±t', icon: 'ğŸ“„' },
            { word: 'Lineal', art: 'das', tr: 'Cetvel', icon: 'ğŸ“' },
            { word: 'MÃ¤ppchen', art: 'das', tr: 'Kalemlik', icon: 'ğŸ‘' },
            { word: 'Bild', art: 'das', tr: 'Resim', icon: 'ğŸ–¼ï¸' },
            { word: 'WÃ¶rterbuch', art: 'das', tr: 'SÃ¶zlÃ¼k', icon: 'ğŸ“•' },
            { word: 'Zeugnis', art: 'das', tr: 'Karne', icon: 'ğŸ“œ' },
            { word: 'Gymnasium', art: 'das', tr: 'Lise', icon: 'ğŸ›ï¸' },
            { word: 'Klassenzimmer', art: 'das', tr: 'SÄ±nÄ±f', icon: 'ğŸšª' }
        ];

        // State Variables
        let currentDeck = []; // To prevent repeats
        let currentWordObj = null;
        let score = 0;
        let streak = 0;
        let gameActive = false;
        let userName = "";

        // Elements
        const screens = {
            start: document.getElementById('start-screen'),
            game: document.getElementById('game-screen'),
            leaderboard: document.getElementById('leaderboard-screen')
        };
        const elUsernameInput = document.getElementById('username-input');
        const elDisplayUsername = document.getElementById('display-username');
        const elWord = document.getElementById('word-display');
        const elTranslation = document.getElementById('translation-display');
        const elIcon = document.getElementById('icon-display');
        const elScore = document.getElementById('score');
        const elStreak = document.getElementById('streak');
        const elOverlay = document.getElementById('result-overlay');
        const elResultTitle = document.getElementById('result-title');
        const elResultMessage = document.getElementById('result-message');
        const elResultIcon = document.getElementById('result-icon');
        const elCardArea = document.getElementById('card-area');

        // --- GAME LOGIC ---

        function startGame() {
            const name = elUsernameInput.value.trim();
            if (!name) {
                alert("LÃ¼tfen bir isim gir!");
                return;
            }
            userName = name;
            elDisplayUsername.innerText = userName;

            // Reset game state
            score = 0;
            streak = 0;
            updateStats();
            
            // Initialize fresh deck
            resetDeck();

            // Switch screens
            switchScreen('game');
            nextQuestion();
        }

        function resetDeck() {
            // Create a shallow copy of the full database
            currentDeck = [...wordDatabase];
        }

        function getNextWordFromDeck() {
            // If deck is empty, refill it (Endless mode)
            if (currentDeck.length === 0) {
                resetDeck();
            }

            // Pick a random index from the current deck
            const randomIndex = Math.floor(Math.random() * currentDeck.length);
            
            // Remove that word from the deck and return it
            // splice returns an array, so we take [0]
            const selectedWord = currentDeck.splice(randomIndex, 1)[0];
            
            return selectedWord;
        }

        function nextQuestion() {
            elOverlay.classList.add('hidden');
            gameActive = true;
            
            currentWordObj = getNextWordFromDeck();
            
            // Update UI
            elWord.innerText = currentWordObj.word;
            elTranslation.innerText = currentWordObj.tr;
            elIcon.innerText = currentWordObj.icon;
            
            // Reset animations
            elCardArea.classList.remove('shake');
            elIcon.classList.remove('correct-pop');
        }

        function checkAnswer(selectedArticle) {
            if (!gameActive) return;
            gameActive = false;

            const isCorrect = selectedArticle === currentWordObj.art;
            const correctArticle = currentWordObj.art.charAt(0).toUpperCase() + currentWordObj.art.slice(1);

            if (isCorrect) {
                score += 10 + (streak * 2);
                streak++;
                
                elResultIcon.innerText = "ğŸ‰";
                elResultTitle.innerText = "Harika!";
                elResultTitle.className = "text-3xl font-black mb-1 text-green-600";
                elResultMessage.innerHTML = `DoÄŸru cevap: <span class="font-bold text-green-600">${correctArticle}</span> ${currentWordObj.word}`;
                elIcon.classList.add('correct-pop');
                
                updateStats();
                setTimeout(() => showOverlay(), 400);
            } else {
                streak = 0;
                
                elResultIcon.innerText = "ğŸ˜”";
                elResultTitle.innerText = "YanlÄ±ÅŸ...";
                elResultTitle.className = "text-3xl font-black mb-1 text-red-600";
                
                let colorClass = "text-slate-800";
                if(currentWordObj.art === 'der') colorClass = "text-blue-600";
                if(currentWordObj.art === 'die') colorClass = "text-red-600";
                if(currentWordObj.art === 'das') colorClass = "text-green-600";

                elResultMessage.innerHTML = `DoÄŸrusu: <span class="font-bold ${colorClass}">${correctArticle}</span> ${currentWordObj.word}`;
                elCardArea.classList.add('shake');
                
                updateStats();
                setTimeout(() => showOverlay(), 500);
            }
        }

        function updateStats() {
            elScore.innerText = score;
            elStreak.innerText = streak + " ğŸ”¥";
        }

        function showOverlay() {
            elOverlay.classList.remove('hidden');
        }

        // --- LEADERBOARD & END GAME ---

        function endGame() {
            saveScore(userName, score);
            document.getElementById('final-score').innerText = score;
            document.getElementById('final-username').innerText = userName;
            renderLeaderboard('full-leaderboard');
            switchScreen('leaderboard');
        }

        function resetGame() {
            elUsernameInput.value = ""; // Clear name or keep it? Let's clear for new player
            renderLeaderboard('mini-leaderboard');
            switchScreen('start');
        }

        function saveScore(name, score) {
            if(score === 0) return; // Don't save 0 scores

            let scores = JSON.parse(localStorage.getItem('artikelGameScores')) || [];
            scores.push({ name: name, score: score, date: new Date().toLocaleDateString() });
            
            // Sort desc
            scores.sort((a, b) => b.score - a.score);
            
            // Keep top 10
            scores = scores.slice(0, 10);
            
            localStorage.setItem('artikelGameScores', JSON.stringify(scores));
        }

        function renderLeaderboard(elementId) {
            const container = document.getElementById(elementId);
            const scores = JSON.parse(localStorage.getItem('artikelGameScores')) || [];
            
            container.innerHTML = "";
            
            if (scores.length === 0) {
                container.innerHTML = "<div class='text-slate-400 italic text-center'>HenÃ¼z kayÄ±tlÄ± skor yok. Ä°lk sen ol!</div>";
                return;
            }

            scores.forEach((s, index) => {
                const isTop = index === 0 ? "bg-yellow-100 border-yellow-200" : "bg-slate-50 border-slate-100";
                const rankIcon = index === 0 ? "ğŸ‘‘" : (index + 1) + ".";
                
                const html = `
                    <div class="flex justify-between items-center p-3 rounded-lg border ${isTop}">
                        <div class="flex items-center gap-3">
                            <span class="font-bold text-slate-400 w-6 text-center">${rankIcon}</span>
                            <span class="font-bold text-slate-700">${s.name}</span>
                        </div>
                        <span class="font-black text-blue-600">${s.score}</span>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function switchScreen(screenName) {
            Object.values(screens).forEach(el => el.classList.add('hidden-screen'));
            screens[screenName].classList.remove('hidden-screen');
        }

        // Init
        renderLeaderboard('mini-leaderboard');

    </script>
</body>
</html>
